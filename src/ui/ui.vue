<template>
  <div id="ui" class="min-h-full p-6">
    <div class="bg-white shadow overflow-hidden sm:rounded-md">
      <ul class="divide-y divide-gray-200">
        <li>
          <a class="block hover:bg-gray-50">
            <div class="px-4 py-4 sm:px-6">
              <div class="flex items-center justify-between">
                <label class="inline-flex items-center">
                  <input type="checkbox" @change="selectAll" />
                  <span class="ml-2 text-md text-gray-700 md:truncate">Select All</span>
                </label>
              </div>
            </div>
          </a>
        </li>
        <li v-for="page in pages" :key="page.nodeId">
          <a class="block hover:bg-gray-50">
            <div class="px-4 py-4 sm:px-6">
              <div class="flex items-center justify-between">
                <label class="inline-flex items-center">
                  <input type="checkbox" :value="page.nodeId" v-model="checkedPages.value" />
                  <span class="ml-2 text-md text-gray-700 md:truncate">{{ page.name }}</span>
                </label>
              </div>
            </div>
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div>
    <canvas id="baselineRef" ref="baselineRef" class="border border-2"></canvas>
    <canvas ref="comparisionRef"></canvas>
    <canvas ref="diffRef"></canvas>
    <button @click="diff">diff</button>
  </div>
</template>

<script setup>

import styles from 'figma-plugin-ds/dist/figma-plugin-ds.css'
import pixelmatch from 'pixelmatch'
import { PageSet } from './model/PageSet'
import { Page } from './model/Page'

import {
  dispatch,
  handleEvent
} from "./uiMessageHandler";
import {
  onMounted,
  ref,
  reactive,
  computed
} from 'vue';

const raw = {
    "0": 137,
    "1": 80,
    "2": 78,
    "3": 71,
    "4": 13,
    "5": 10,
    "6": 26,
    "7": 10,
    "8": 0,
    "9": 0,
    "10": 0,
    "11": 13,
    "12": 73,
    "13": 72,
    "14": 68,
    "15": 82,
    "16": 0,
    "17": 0,
    "18": 1,
    "19": 105,
    "20": 0,
    "21": 0,
    "22": 1,
    "23": 193,
    "24": 8,
    "25": 6,
    "26": 0,
    "27": 0,
    "28": 0,
    "29": 171,
    "30": 52,
    "31": 74,
    "32": 205,
    "33": 0,
    "34": 0,
    "35": 0,
    "36": 9,
    "37": 112,
    "38": 72,
    "39": 89,
    "40": 115,
    "41": 0,
    "42": 0,
    "43": 11,
    "44": 19,
    "45": 0,
    "46": 0,
    "47": 11,
    "48": 19,
    "49": 1,
    "50": 0,
    "51": 154,
    "52": 156,
    "53": 24,
    "54": 0,
    "55": 0,
    "56": 0,
    "57": 1,
    "58": 115,
    "59": 82,
    "60": 71,
    "61": 66,
    "62": 0,
    "63": 174,
    "64": 206,
    "65": 28,
    "66": 233,
    "67": 0,
    "68": 0,
    "69": 0,
    "70": 4,
    "71": 103,
    "72": 65,
    "73": 77,
    "74": 65,
    "75": 0,
    "76": 0,
    "77": 177,
    "78": 143,
    "79": 11,
    "80": 252,
    "81": 97,
    "82": 5,
    "83": 0,
    "84": 0,
    "85": 6,
    "86": 77,
    "87": 73,
    "88": 68,
    "89": 65,
    "90": 84,
    "91": 120,
    "92": 1,
    "93": 237,
    "94": 214,
    "95": 1,
    "96": 13,
    "97": 132,
    "98": 64,
    "99": 16,
    "100": 192,
    "101": 192,
    "102": 229,
    "103": 243,
    "104": 174,
    "105": 78,
    "106": 255,
    "107": 233,
    "108": 2,
    "109": 76,
    "110": 64,
    "111": 26,
    "112": 50,
    "113": 35,
    "114": 162,
    "115": 233,
    "116": 113,
    "117": 222,
    "118": 6,
    "119": 128,
    "120": 164,
    "121": 223,
    "122": 0,
    "123": 144,
    "124": 37,
    "125": 210,
    "126": 0,
    "127": 97,
    "128": 34,
    "129": 13,
    "130": 16,
    "131": 38,
    "132": 210,
    "133": 0,
    "134": 97,
    "135": 34,
    "136": 13,
    "137": 16,
    "138": 38,
    "139": 210,
    "140": 0,
    "141": 97,
    "142": 34,
    "143": 13,
    "144": 16,
    "145": 38,
    "146": 210,
    "147": 0,
    "148": 97,
    "149": 34,
    "150": 13,
    "151": 16,
    "152": 38,
    "153": 210,
    "154": 0,
    "155": 97,
    "156": 34,
    "157": 13,
    "158": 16,
    "159": 38,
    "160": 210,
    "161": 0,
    "162": 97,
    "163": 34,
    "164": 13,
    "165": 16,
    "166": 38,
    "167": 210,
    "168": 0,
    "169": 97,
    "170": 34,
    "171": 13,
    "172": 16,
    "173": 38,
    "174": 210,
    "175": 0,
    "176": 97,
    "177": 34,
    "178": 13,
    "179": 16,
    "180": 38,
    "181": 210,
    "182": 0,
    "183": 97,
    "184": 34,
    "185": 13,
    "186": 16,
    "187": 38,
    "188": 210,
    "189": 0,
    "190": 97,
    "191": 34,
    "192": 13,
    "193": 16,
    "194": 38,
    "195": 210,
    "196": 0,
    "197": 97,
    "198": 34,
    "199": 13,
    "200": 16,
    "201": 38,
    "202": 210,
    "203": 0,
    "204": 97,
    "205": 34,
    "206": 13,
    "207": 16,
    "208": 38,
    "209": 210,
    "210": 0,
    "211": 97,
    "212": 34,
    "213": 13,
    "214": 16,
    "215": 38,
    "216": 210,
    "217": 0,
    "218": 97,
    "219": 34,
    "220": 13,
    "221": 16,
    "222": 38,
    "223": 210,
    "224": 0,
    "225": 97,
    "226": 34,
    "227": 13,
    "228": 16,
    "229": 38,
    "230": 210,
    "231": 0,
    "232": 97,
    "233": 34,
    "234": 13,
    "235": 16,
    "236": 38,
    "237": 210,
    "238": 0,
    "239": 97,
    "240": 34,
    "241": 13,
    "242": 16,
    "243": 38,
    "244": 210,
    "245": 0,
    "246": 97,
    "247": 34,
    "248": 13,
    "249": 16,
    "250": 38,
    "251": 210,
    "252": 0,
    "253": 97,
    "254": 34,
    "255": 13,
    "256": 16,
    "257": 38,
    "258": 210,
    "259": 0,
    "260": 97,
    "261": 34,
    "262": 13,
    "263": 16,
    "264": 38,
    "265": 210,
    "266": 0,
    "267": 97,
    "268": 34,
    "269": 13,
    "270": 16,
    "271": 38,
    "272": 210,
    "273": 0,
    "274": 97,
    "275": 34,
    "276": 13,
    "277": 16,
    "278": 38,
    "279": 210,
    "280": 0,
    "281": 97,
    "282": 34,
    "283": 13,
    "284": 16,
    "285": 38,
    "286": 210,
    "287": 0,
    "288": 97,
    "289": 34,
    "290": 13,
    "291": 16,
    "292": 38,
    "293": 210,
    "294": 0,
    "295": 97,
    "296": 34,
    "297": 13,
    "298": 16,
    "299": 38,
    "300": 210,
    "301": 0,
    "302": 97,
    "303": 34,
    "304": 13,
    "305": 16,
    "306": 38,
    "307": 210,
    "308": 0,
    "309": 97,
    "310": 34,
    "311": 13,
    "312": 16,
    "313": 38,
    "314": 210,
    "315": 0,
    "316": 97,
    "317": 34,
    "318": 13,
    "319": 16,
    "320": 38,
    "321": 210,
    "322": 0,
    "323": 97,
    "324": 255,
    "325": 121,
    "326": 209,
    "327": 222,
    "328": 123,
    "329": 224,
    "330": 73,
    "331": 107,
    "332": 173,
    "333": 129,
    "334": 47,
    "335": 113,
    "336": 210,
    "337": 0,
    "338": 97,
    "339": 34,
    "340": 13,
    "341": 16,
    "342": 38,
    "343": 210,
    "344": 0,
    "345": 97,
    "346": 34,
    "347": 13,
    "348": 16,
    "349": 38,
    "350": 210,
    "351": 0,
    "352": 97,
    "353": 34,
    "354": 13,
    "355": 16,
    "356": 38,
    "357": 210,
    "358": 0,
    "359": 97,
    "360": 34,
    "361": 13,
    "362": 16,
    "363": 38,
    "364": 210,
    "365": 0,
    "366": 97,
    "367": 34,
    "368": 13,
    "369": 16,
    "370": 38,
    "371": 210,
    "372": 0,
    "373": 97,
    "374": 34,
    "375": 13,
    "376": 16,
    "377": 38,
    "378": 210,
    "379": 0,
    "380": 97,
    "381": 34,
    "382": 13,
    "383": 16,
    "384": 38,
    "385": 210,
    "386": 0,
    "387": 97,
    "388": 34,
    "389": 13,
    "390": 16,
    "391": 38,
    "392": 210,
    "393": 0,
    "394": 97,
    "395": 34,
    "396": 13,
    "397": 16,
    "398": 38,
    "399": 210,
    "400": 0,
    "401": 97,
    "402": 34,
    "403": 13,
    "404": 16,
    "405": 38,
    "406": 210,
    "407": 0,
    "408": 97,
    "409": 34,
    "410": 13,
    "411": 16,
    "412": 38,
    "413": 210,
    "414": 0,
    "415": 97,
    "416": 34,
    "417": 13,
    "418": 16,
    "419": 38,
    "420": 210,
    "421": 0,
    "422": 97,
    "423": 34,
    "424": 13,
    "425": 16,
    "426": 38,
    "427": 210,
    "428": 0,
    "429": 97,
    "430": 34,
    "431": 13,
    "432": 16,
    "433": 38,
    "434": 210,
    "435": 0,
    "436": 97,
    "437": 34,
    "438": 13,
    "439": 16,
    "440": 38,
    "441": 210,
    "442": 0,
    "443": 97,
    "444": 34,
    "445": 13,
    "446": 16,
    "447": 38,
    "448": 210,
    "449": 0,
    "450": 97,
    "451": 34,
    "452": 13,
    "453": 16,
    "454": 38,
    "455": 210,
    "456": 0,
    "457": 97,
    "458": 34,
    "459": 13,
    "460": 16,
    "461": 38,
    "462": 210,
    "463": 0,
    "464": 97,
    "465": 34,
    "466": 13,
    "467": 16,
    "468": 38,
    "469": 210,
    "470": 0,
    "471": 97,
    "472": 34,
    "473": 13,
    "474": 16,
    "475": 38,
    "476": 210,
    "477": 0,
    "478": 97,
    "479": 34,
    "480": 13,
    "481": 16,
    "482": 38,
    "483": 210,
    "484": 0,
    "485": 97,
    "486": 34,
    "487": 13,
    "488": 16,
    "489": 38,
    "490": 210,
    "491": 0,
    "492": 97,
    "493": 34,
    "494": 13,
    "495": 16,
    "496": 38,
    "497": 210,
    "498": 0,
    "499": 97,
    "500": 34,
    "501": 13,
    "502": 16,
    "503": 38,
    "504": 210,
    "505": 0,
    "506": 97,
    "507": 34,
    "508": 13,
    "509": 16,
    "510": 38,
    "511": 210,
    "512": 0,
    "513": 97,
    "514": 199,
    "515": 121,
    "516": 27,
    "517": 0,
    "518": 146,
    "519": 156,
    "520": 52,
    "521": 64,
    "522": 152,
    "523": 72,
    "524": 3,
    "525": 132,
    "526": 137,
    "527": 52,
    "528": 64,
    "529": 152,
    "530": 72,
    "531": 3,
    "532": 132,
    "533": 137,
    "534": 52,
    "535": 64,
    "536": 152,
    "537": 72,
    "538": 3,
    "539": 132,
    "540": 137,
    "541": 52,
    "542": 64,
    "543": 152,
    "544": 72,
    "545": 3,
    "546": 132,
    "547": 137,
    "548": 52,
    "549": 64,
    "550": 152,
    "551": 72,
    "552": 3,
    "553": 132,
    "554": 137,
    "555": 52,
    "556": 64,
    "557": 152,
    "558": 72,
    "559": 3,
    "560": 132,
    "561": 137,
    "562": 52,
    "563": 64,
    "564": 152,
    "565": 72,
    "566": 3,
    "567": 132,
    "568": 137,
    "569": 52,
    "570": 64,
    "571": 152,
    "572": 72,
    "573": 3,
    "574": 132,
    "575": 137,
    "576": 52,
    "577": 64,
    "578": 152,
    "579": 72,
    "580": 3,
    "581": 132,
    "582": 137,
    "583": 52,
    "584": 64,
    "585": 152,
    "586": 72,
    "587": 3,
    "588": 132,
    "589": 137,
    "590": 52,
    "591": 64,
    "592": 152,
    "593": 72,
    "594": 3,
    "595": 132,
    "596": 137,
    "597": 52,
    "598": 64,
    "599": 152,
    "600": 72,
    "601": 3,
    "602": 132,
    "603": 137,
    "604": 52,
    "605": 64,
    "606": 152,
    "607": 72,
    "608": 3,
    "609": 132,
    "610": 137,
    "611": 52,
    "612": 64,
    "613": 152,
    "614": 72,
    "615": 3,
    "616": 132,
    "617": 137,
    "618": 52,
    "619": 64,
    "620": 152,
    "621": 72,
    "622": 3,
    "623": 132,
    "624": 137,
    "625": 52,
    "626": 64,
    "627": 152,
    "628": 72,
    "629": 3,
    "630": 132,
    "631": 137,
    "632": 52,
    "633": 64,
    "634": 152,
    "635": 72,
    "636": 3,
    "637": 132,
    "638": 137,
    "639": 52,
    "640": 64,
    "641": 152,
    "642": 72,
    "643": 3,
    "644": 132,
    "645": 137,
    "646": 52,
    "647": 64,
    "648": 152,
    "649": 72,
    "650": 3,
    "651": 132,
    "652": 137,
    "653": 52,
    "654": 64,
    "655": 152,
    "656": 72,
    "657": 3,
    "658": 132,
    "659": 137,
    "660": 52,
    "661": 64,
    "662": 152,
    "663": 72,
    "664": 3,
    "665": 132,
    "666": 137,
    "667": 52,
    "668": 64,
    "669": 152,
    "670": 72,
    "671": 3,
    "672": 132,
    "673": 137,
    "674": 52,
    "675": 64,
    "676": 152,
    "677": 72,
    "678": 3,
    "679": 132,
    "680": 137,
    "681": 52,
    "682": 64,
    "683": 152,
    "684": 72,
    "685": 3,
    "686": 132,
    "687": 137,
    "688": 52,
    "689": 64,
    "690": 152,
    "691": 72,
    "692": 3,
    "693": 132,
    "694": 137,
    "695": 52,
    "696": 64,
    "697": 152,
    "698": 72,
    "699": 3,
    "700": 132,
    "701": 137,
    "702": 52,
    "703": 64,
    "704": 152,
    "705": 72,
    "706": 3,
    "707": 132,
    "708": 137,
    "709": 52,
    "710": 64,
    "711": 152,
    "712": 72,
    "713": 3,
    "714": 132,
    "715": 137,
    "716": 52,
    "717": 64,
    "718": 152,
    "719": 72,
    "720": 3,
    "721": 132,
    "722": 137,
    "723": 52,
    "724": 64,
    "725": 152,
    "726": 72,
    "727": 3,
    "728": 132,
    "729": 137,
    "730": 52,
    "731": 64,
    "732": 152,
    "733": 72,
    "734": 3,
    "735": 132,
    "736": 137,
    "737": 52,
    "738": 64,
    "739": 152,
    "740": 72,
    "741": 3,
    "742": 132,
    "743": 137,
    "744": 52,
    "745": 64,
    "746": 152,
    "747": 72,
    "748": 3,
    "749": 132,
    "750": 137,
    "751": 52,
    "752": 64,
    "753": 152,
    "754": 72,
    "755": 3,
    "756": 132,
    "757": 137,
    "758": 52,
    "759": 64,
    "760": 152,
    "761": 72,
    "762": 3,
    "763": 132,
    "764": 137,
    "765": 52,
    "766": 64,
    "767": 152,
    "768": 72,
    "769": 3,
    "770": 132,
    "771": 137,
    "772": 52,
    "773": 64,
    "774": 152,
    "775": 72,
    "776": 3,
    "777": 132,
    "778": 137,
    "779": 52,
    "780": 64,
    "781": 152,
    "782": 72,
    "783": 3,
    "784": 132,
    "785": 137,
    "786": 52,
    "787": 64,
    "788": 152,
    "789": 72,
    "790": 3,
    "791": 132,
    "792": 137,
    "793": 52,
    "794": 64,
    "795": 152,
    "796": 72,
    "797": 3,
    "798": 132,
    "799": 137,
    "800": 52,
    "801": 64,
    "802": 152,
    "803": 72,
    "804": 3,
    "805": 132,
    "806": 137,
    "807": 52,
    "808": 64,
    "809": 152,
    "810": 72,
    "811": 3,
    "812": 132,
    "813": 137,
    "814": 52,
    "815": 64,
    "816": 152,
    "817": 72,
    "818": 3,
    "819": 132,
    "820": 137,
    "821": 52,
    "822": 64,
    "823": 152,
    "824": 72,
    "825": 3,
    "826": 132,
    "827": 137,
    "828": 52,
    "829": 64,
    "830": 152,
    "831": 72,
    "832": 3,
    "833": 132,
    "834": 137,
    "835": 52,
    "836": 64,
    "837": 152,
    "838": 72,
    "839": 3,
    "840": 132,
    "841": 137,
    "842": 52,
    "843": 64,
    "844": 152,
    "845": 72,
    "846": 3,
    "847": 132,
    "848": 137,
    "849": 52,
    "850": 64,
    "851": 152,
    "852": 72,
    "853": 3,
    "854": 132,
    "855": 137,
    "856": 52,
    "857": 64,
    "858": 152,
    "859": 72,
    "860": 3,
    "861": 132,
    "862": 137,
    "863": 52,
    "864": 64,
    "865": 152,
    "866": 72,
    "867": 3,
    "868": 132,
    "869": 137,
    "870": 52,
    "871": 64,
    "872": 152,
    "873": 72,
    "874": 3,
    "875": 132,
    "876": 137,
    "877": 52,
    "878": 64,
    "879": 152,
    "880": 72,
    "881": 3,
    "882": 132,
    "883": 137,
    "884": 52,
    "885": 64,
    "886": 152,
    "887": 72,
    "888": 3,
    "889": 132,
    "890": 137,
    "891": 52,
    "892": 64,
    "893": 152,
    "894": 72,
    "895": 3,
    "896": 132,
    "897": 137,
    "898": 52,
    "899": 64,
    "900": 152,
    "901": 72,
    "902": 3,
    "903": 132,
    "904": 137,
    "905": 52,
    "906": 64,
    "907": 152,
    "908": 72,
    "909": 3,
    "910": 132,
    "911": 137,
    "912": 52,
    "913": 64,
    "914": 152,
    "915": 72,
    "916": 3,
    "917": 132,
    "918": 137,
    "919": 52,
    "920": 64,
    "921": 152,
    "922": 72,
    "923": 3,
    "924": 132,
    "925": 137,
    "926": 52,
    "927": 64,
    "928": 152,
    "929": 72,
    "930": 3,
    "931": 132,
    "932": 137,
    "933": 52,
    "934": 64,
    "935": 152,
    "936": 72,
    "937": 3,
    "938": 132,
    "939": 137,
    "940": 52,
    "941": 64,
    "942": 152,
    "943": 72,
    "944": 3,
    "945": 132,
    "946": 137,
    "947": 52,
    "948": 64,
    "949": 152,
    "950": 72,
    "951": 3,
    "952": 132,
    "953": 137,
    "954": 52,
    "955": 64,
    "956": 152,
    "957": 72,
    "958": 3,
    "959": 132,
    "960": 137,
    "961": 52,
    "962": 64,
    "963": 152,
    "964": 72,
    "965": 3,
    "966": 132,
    "967": 137,
    "968": 52,
    "969": 64,
    "970": 152,
    "971": 72,
    "972": 3,
    "973": 132,
    "974": 137,
    "975": 52,
    "976": 64,
    "977": 152,
    "978": 72,
    "979": 3,
    "980": 132,
    "981": 137,
    "982": 52,
    "983": 64,
    "984": 152,
    "985": 72,
    "986": 3,
    "987": 132,
    "988": 137,
    "989": 52,
    "990": 64,
    "991": 152,
    "992": 72,
    "993": 3,
    "994": 132,
    "995": 137,
    "996": 52,
    "997": 64,
    "998": 152,
    "999": 72,
    "1000": 3,
    "1001": 132,
    "1002": 137,
    "1003": 52,
    "1004": 64,
    "1005": 152,
    "1006": 72,
    "1007": 3,
    "1008": 132,
    "1009": 137,
    "1010": 52,
    "1011": 64,
    "1012": 152,
    "1013": 72,
    "1014": 3,
    "1015": 132,
    "1016": 137,
    "1017": 52,
    "1018": 64,
    "1019": 152,
    "1020": 72,
    "1021": 3,
    "1022": 132,
    "1023": 137,
    "1024": 52,
    "1025": 64,
    "1026": 152,
    "1027": 72,
    "1028": 3,
    "1029": 132,
    "1030": 137,
    "1031": 52,
    "1032": 64,
    "1033": 152,
    "1034": 72,
    "1035": 3,
    "1036": 132,
    "1037": 137,
    "1038": 52,
    "1039": 64,
    "1040": 152,
    "1041": 72,
    "1042": 3,
    "1043": 132,
    "1044": 137,
    "1045": 52,
    "1046": 64,
    "1047": 152,
    "1048": 72,
    "1049": 3,
    "1050": 132,
    "1051": 137,
    "1052": 52,
    "1053": 64,
    "1054": 152,
    "1055": 72,
    "1056": 3,
    "1057": 132,
    "1058": 137,
    "1059": 52,
    "1060": 64,
    "1061": 152,
    "1062": 72,
    "1063": 3,
    "1064": 132,
    "1065": 137,
    "1066": 52,
    "1067": 64,
    "1068": 152,
    "1069": 72,
    "1070": 3,
    "1071": 132,
    "1072": 137,
    "1073": 52,
    "1074": 64,
    "1075": 152,
    "1076": 72,
    "1077": 3,
    "1078": 132,
    "1079": 137,
    "1080": 52,
    "1081": 64,
    "1082": 152,
    "1083": 72,
    "1084": 3,
    "1085": 132,
    "1086": 137,
    "1087": 52,
    "1088": 64,
    "1089": 152,
    "1090": 72,
    "1091": 3,
    "1092": 132,
    "1093": 137,
    "1094": 52,
    "1095": 64,
    "1096": 152,
    "1097": 72,
    "1098": 3,
    "1099": 132,
    "1100": 137,
    "1101": 52,
    "1102": 64,
    "1103": 152,
    "1104": 72,
    "1105": 3,
    "1106": 132,
    "1107": 137,
    "1108": 52,
    "1109": 64,
    "1110": 152,
    "1111": 72,
    "1112": 3,
    "1113": 132,
    "1114": 137,
    "1115": 52,
    "1116": 64,
    "1117": 152,
    "1118": 72,
    "1119": 3,
    "1120": 132,
    "1121": 137,
    "1122": 52,
    "1123": 64,
    "1124": 152,
    "1125": 72,
    "1126": 3,
    "1127": 132,
    "1128": 137,
    "1129": 52,
    "1130": 64,
    "1131": 152,
    "1132": 72,
    "1133": 3,
    "1134": 132,
    "1135": 137,
    "1136": 52,
    "1137": 64,
    "1138": 152,
    "1139": 72,
    "1140": 3,
    "1141": 132,
    "1142": 137,
    "1143": 52,
    "1144": 64,
    "1145": 152,
    "1146": 72,
    "1147": 3,
    "1148": 132,
    "1149": 137,
    "1150": 52,
    "1151": 64,
    "1152": 152,
    "1153": 72,
    "1154": 3,
    "1155": 132,
    "1156": 137,
    "1157": 52,
    "1158": 64,
    "1159": 152,
    "1160": 72,
    "1161": 3,
    "1162": 132,
    "1163": 137,
    "1164": 52,
    "1165": 64,
    "1166": 152,
    "1167": 72,
    "1168": 3,
    "1169": 132,
    "1170": 137,
    "1171": 52,
    "1172": 64,
    "1173": 152,
    "1174": 72,
    "1175": 3,
    "1176": 132,
    "1177": 137,
    "1178": 52,
    "1179": 64,
    "1180": 152,
    "1181": 72,
    "1182": 3,
    "1183": 132,
    "1184": 137,
    "1185": 52,
    "1186": 64,
    "1187": 152,
    "1188": 72,
    "1189": 3,
    "1190": 132,
    "1191": 137,
    "1192": 52,
    "1193": 64,
    "1194": 152,
    "1195": 72,
    "1196": 3,
    "1197": 132,
    "1198": 137,
    "1199": 52,
    "1200": 64,
    "1201": 152,
    "1202": 72,
    "1203": 3,
    "1204": 132,
    "1205": 137,
    "1206": 52,
    "1207": 64,
    "1208": 152,
    "1209": 72,
    "1210": 3,
    "1211": 132,
    "1212": 137,
    "1213": 52,
    "1214": 64,
    "1215": 152,
    "1216": 72,
    "1217": 3,
    "1218": 132,
    "1219": 137,
    "1220": 52,
    "1221": 64,
    "1222": 152,
    "1223": 72,
    "1224": 3,
    "1225": 132,
    "1226": 137,
    "1227": 52,
    "1228": 64,
    "1229": 152,
    "1230": 72,
    "1231": 3,
    "1232": 132,
    "1233": 137,
    "1234": 52,
    "1235": 64,
    "1236": 152,
    "1237": 72,
    "1238": 3,
    "1239": 132,
    "1240": 137,
    "1241": 52,
    "1242": 64,
    "1243": 152,
    "1244": 72,
    "1245": 3,
    "1246": 132,
    "1247": 137,
    "1248": 52,
    "1249": 64,
    "1250": 152,
    "1251": 72,
    "1252": 3,
    "1253": 132,
    "1254": 137,
    "1255": 52,
    "1256": 64,
    "1257": 152,
    "1258": 72,
    "1259": 3,
    "1260": 132,
    "1261": 137,
    "1262": 52,
    "1263": 64,
    "1264": 152,
    "1265": 72,
    "1266": 3,
    "1267": 132,
    "1268": 137,
    "1269": 52,
    "1270": 64,
    "1271": 152,
    "1272": 72,
    "1273": 3,
    "1274": 132,
    "1275": 137,
    "1276": 52,
    "1277": 64,
    "1278": 152,
    "1279": 72,
    "1280": 3,
    "1281": 132,
    "1282": 137,
    "1283": 52,
    "1284": 64,
    "1285": 152,
    "1286": 72,
    "1287": 3,
    "1288": 132,
    "1289": 137,
    "1290": 52,
    "1291": 64,
    "1292": 152,
    "1293": 72,
    "1294": 3,
    "1295": 132,
    "1296": 137,
    "1297": 52,
    "1298": 64,
    "1299": 152,
    "1300": 72,
    "1301": 3,
    "1302": 132,
    "1303": 137,
    "1304": 52,
    "1305": 64,
    "1306": 152,
    "1307": 72,
    "1308": 3,
    "1309": 132,
    "1310": 137,
    "1311": 52,
    "1312": 64,
    "1313": 152,
    "1314": 72,
    "1315": 3,
    "1316": 132,
    "1317": 137,
    "1318": 52,
    "1319": 64,
    "1320": 152,
    "1321": 72,
    "1322": 3,
    "1323": 132,
    "1324": 137,
    "1325": 52,
    "1326": 64,
    "1327": 152,
    "1328": 72,
    "1329": 3,
    "1330": 132,
    "1331": 137,
    "1332": 52,
    "1333": 64,
    "1334": 152,
    "1335": 72,
    "1336": 3,
    "1337": 132,
    "1338": 137,
    "1339": 52,
    "1340": 64,
    "1341": 152,
    "1342": 72,
    "1343": 3,
    "1344": 132,
    "1345": 137,
    "1346": 52,
    "1347": 64,
    "1348": 152,
    "1349": 72,
    "1350": 3,
    "1351": 132,
    "1352": 137,
    "1353": 52,
    "1354": 64,
    "1355": 152,
    "1356": 72,
    "1357": 3,
    "1358": 132,
    "1359": 137,
    "1360": 52,
    "1361": 64,
    "1362": 152,
    "1363": 72,
    "1364": 3,
    "1365": 132,
    "1366": 137,
    "1367": 52,
    "1368": 64,
    "1369": 152,
    "1370": 72,
    "1371": 3,
    "1372": 132,
    "1373": 137,
    "1374": 52,
    "1375": 64,
    "1376": 152,
    "1377": 72,
    "1378": 3,
    "1379": 132,
    "1380": 137,
    "1381": 52,
    "1382": 64,
    "1383": 152,
    "1384": 72,
    "1385": 3,
    "1386": 132,
    "1387": 137,
    "1388": 52,
    "1389": 64,
    "1390": 152,
    "1391": 72,
    "1392": 3,
    "1393": 132,
    "1394": 137,
    "1395": 52,
    "1396": 64,
    "1397": 152,
    "1398": 72,
    "1399": 3,
    "1400": 132,
    "1401": 137,
    "1402": 52,
    "1403": 64,
    "1404": 152,
    "1405": 72,
    "1406": 3,
    "1407": 132,
    "1408": 137,
    "1409": 52,
    "1410": 64,
    "1411": 152,
    "1412": 72,
    "1413": 3,
    "1414": 132,
    "1415": 137,
    "1416": 52,
    "1417": 64,
    "1418": 152,
    "1419": 72,
    "1420": 3,
    "1421": 132,
    "1422": 137,
    "1423": 52,
    "1424": 64,
    "1425": 152,
    "1426": 72,
    "1427": 3,
    "1428": 132,
    "1429": 137,
    "1430": 52,
    "1431": 64,
    "1432": 152,
    "1433": 72,
    "1434": 3,
    "1435": 132,
    "1436": 137,
    "1437": 52,
    "1438": 64,
    "1439": 152,
    "1440": 72,
    "1441": 3,
    "1442": 132,
    "1443": 137,
    "1444": 52,
    "1445": 64,
    "1446": 152,
    "1447": 72,
    "1448": 3,
    "1449": 132,
    "1450": 137,
    "1451": 52,
    "1452": 64,
    "1453": 152,
    "1454": 72,
    "1455": 3,
    "1456": 132,
    "1457": 137,
    "1458": 52,
    "1459": 64,
    "1460": 152,
    "1461": 72,
    "1462": 3,
    "1463": 132,
    "1464": 137,
    "1465": 52,
    "1466": 64,
    "1467": 152,
    "1468": 72,
    "1469": 3,
    "1470": 132,
    "1471": 137,
    "1472": 52,
    "1473": 64,
    "1474": 152,
    "1475": 72,
    "1476": 3,
    "1477": 132,
    "1478": 137,
    "1479": 52,
    "1480": 64,
    "1481": 152,
    "1482": 72,
    "1483": 3,
    "1484": 132,
    "1485": 137,
    "1486": 52,
    "1487": 64,
    "1488": 152,
    "1489": 72,
    "1490": 3,
    "1491": 132,
    "1492": 137,
    "1493": 52,
    "1494": 64,
    "1495": 152,
    "1496": 72,
    "1497": 3,
    "1498": 132,
    "1499": 137,
    "1500": 52,
    "1501": 64,
    "1502": 152,
    "1503": 72,
    "1504": 3,
    "1505": 132,
    "1506": 137,
    "1507": 52,
    "1508": 64,
    "1509": 152,
    "1510": 72,
    "1511": 3,
    "1512": 132,
    "1513": 137,
    "1514": 52,
    "1515": 64,
    "1516": 152,
    "1517": 72,
    "1518": 3,
    "1519": 132,
    "1520": 137,
    "1521": 52,
    "1522": 64,
    "1523": 152,
    "1524": 72,
    "1525": 3,
    "1526": 132,
    "1527": 137,
    "1528": 52,
    "1529": 64,
    "1530": 152,
    "1531": 72,
    "1532": 3,
    "1533": 132,
    "1534": 137,
    "1535": 52,
    "1536": 64,
    "1537": 152,
    "1538": 72,
    "1539": 3,
    "1540": 132,
    "1541": 137,
    "1542": 52,
    "1543": 64,
    "1544": 152,
    "1545": 72,
    "1546": 3,
    "1547": 132,
    "1548": 137,
    "1549": 52,
    "1550": 64,
    "1551": 152,
    "1552": 72,
    "1553": 3,
    "1554": 132,
    "1555": 137,
    "1556": 52,
    "1557": 64,
    "1558": 152,
    "1559": 72,
    "1560": 3,
    "1561": 132,
    "1562": 137,
    "1563": 52,
    "1564": 64,
    "1565": 152,
    "1566": 72,
    "1567": 3,
    "1568": 132,
    "1569": 137,
    "1570": 52,
    "1571": 64,
    "1572": 152,
    "1573": 72,
    "1574": 3,
    "1575": 132,
    "1576": 137,
    "1577": 52,
    "1578": 64,
    "1579": 152,
    "1580": 72,
    "1581": 3,
    "1582": 132,
    "1583": 137,
    "1584": 52,
    "1585": 64,
    "1586": 152,
    "1587": 72,
    "1588": 3,
    "1589": 132,
    "1590": 137,
    "1591": 52,
    "1592": 64,
    "1593": 152,
    "1594": 72,
    "1595": 3,
    "1596": 132,
    "1597": 137,
    "1598": 52,
    "1599": 64,
    "1600": 152,
    "1601": 72,
    "1602": 3,
    "1603": 132,
    "1604": 137,
    "1605": 52,
    "1606": 64,
    "1607": 152,
    "1608": 72,
    "1609": 3,
    "1610": 132,
    "1611": 137,
    "1612": 52,
    "1613": 64,
    "1614": 152,
    "1615": 72,
    "1616": 3,
    "1617": 132,
    "1618": 137,
    "1619": 52,
    "1620": 64,
    "1621": 152,
    "1622": 72,
    "1623": 3,
    "1624": 132,
    "1625": 137,
    "1626": 52,
    "1627": 64,
    "1628": 152,
    "1629": 72,
    "1630": 3,
    "1631": 132,
    "1632": 137,
    "1633": 52,
    "1634": 64,
    "1635": 152,
    "1636": 72,
    "1637": 3,
    "1638": 132,
    "1639": 137,
    "1640": 52,
    "1641": 64,
    "1642": 152,
    "1643": 72,
    "1644": 3,
    "1645": 132,
    "1646": 137,
    "1647": 52,
    "1648": 64,
    "1649": 152,
    "1650": 72,
    "1651": 3,
    "1652": 132,
    "1653": 137,
    "1654": 52,
    "1655": 64,
    "1656": 152,
    "1657": 72,
    "1658": 3,
    "1659": 132,
    "1660": 137,
    "1661": 52,
    "1662": 64,
    "1663": 152,
    "1664": 72,
    "1665": 3,
    "1666": 132,
    "1667": 137,
    "1668": 52,
    "1669": 64,
    "1670": 152,
    "1671": 72,
    "1672": 3,
    "1673": 132,
    "1674": 137,
    "1675": 52,
    "1676": 64,
    "1677": 152,
    "1678": 72,
    "1679": 3,
    "1680": 132,
    "1681": 137,
    "1682": 52,
    "1683": 64,
    "1684": 152,
    "1685": 72,
    "1686": 3,
    "1687": 132,
    "1688": 137,
    "1689": 52,
    "1690": 64,
    "1691": 152,
    "1692": 72,
    "1693": 3,
    "1694": 132,
    "1695": 137,
    "1696": 52,
    "1697": 64,
    "1698": 216,
    "1699": 5,
    "1700": 250,
    "1701": 45,
    "1702": 14,
    "1703": 123,
    "1704": 169,
    "1705": 94,
    "1706": 51,
    "1707": 174,
    "1708": 0,
    "1709": 0,
    "1710": 0,
    "1711": 0,
    "1712": 73,
    "1713": 69,
    "1714": 78,
    "1715": 68,
    "1716": 174,
    "1717": 66,
    "1718": 96,
    "1719": 130
}

const testImage = new Uint8Array(Object.values(raw))

let all = false
let checkedPages = reactive([])
const baselineRef = ref(null)
const comparisionRef = ref(null)
const diffRef = ref(null)
const pageSet = reactive(new PageSet())
let pages = computed(() => {
  return pageSet.pages
})


function diff() {
  console.log('heard');
}
function selectAll() {
  if (!all) {
    const allIds = pages.map((page) => page.nodeId);
    console.log('all ids', allIds);
    checkedPages.value = allIds;
    all = true;
  } else {
    checkedPages.value = [];
    all = false;
  }
}

dispatch("fetchPages");



async function draw(data) {
  return new Promise((resolve, reject) => {
    const canvas = baselineRef.value
    const baselineImage = new Image();
    baselineImage.addEventListener("load", () => {
      canvas.width = baselineImage.width;
      canvas.height = baselineImage.height;
      canvas.getContext("2d").drawImage(baselineImage, 0, 0);
    });
        const url = URL.createObjectURL(new Blob([data]));
    baselineImage.src = url
    resolve();
  });
}

async function loadData() {
  console.log('loading dat');
  return new Promise(async (resolve, reject) => {
    try {

      const reader = new FileReader();
      reader.readAsArrayBuffer(new Blob(testImage));
      reader.onloadend = function () {
        const base64data = reader.result;
        if (base64data) {
          resolve(base64data);
        } else {
          reject('errr');
        }
      };
    } catch (e) {
      reject('unable', e)

    }
  })


}

onMounted(async () => {

  // The following shows how messages from the main code can be handled in the UI code.
  handleEvent("pagesFetched", figmaData => {
    console.log('fig', figmaData);
    figmaData.map(pageData => {
      const page = new Page(pageData.name, pageData.nodeId)
      page.setBaselineImage(pageData.image)
      pageSet.addPage(page)
    })
  });

  draw(testImage)


})

</script>

<style>
@tailwind base;
@tailwind components;
@tailwind utilities;
</style>